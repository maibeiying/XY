(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{106:function(t,e,s){t.exports={default:s(107),__esModule:!0}},107:function(t,e,s){s(47),s(46),t.exports=s(108)},108:function(t,e,s){var a=s(2),i=s(48);t.exports=s(3).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return a(e.call(t))}},126:function(t,e,s){"use strict";s.r(e);var a=s(127),i=s.n(a);for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);e.default=i.a},127:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(s(106)),i=n(s(147));function n(t){return t&&t.__esModule?t:{default:t}}e.default={components:{upload:i.default},data:function(){return{name:"",price:"",cateId:"",categorys:{},desc:"",isShow:!0,goodsId:"",ztList:[],tlList:[],ztUploadFiles:[],tLUploadFiles:[]}},created:function(){var t=location.href.match(/.??id=(.*)/);t&&(this.goodsId=t[1],this.queryGoods({id:this.goodsId}))},mounted:function(){this.getCates()},methods:{queryGoods:function(t){var e=this;this.$http.post("./goods/queryGoods",t).then(function(t){if(1!==t.code||!t.result.length)return e.$Message.error("获取商品信息失败");var s=t.result[0];e.price=s.price,e.cateId=s.cateId,e.name=s.name,e.isShow=1===s.isShow,e.ztList=[{name:s.mainImg.split("/").pop(),url:s.mainImg,status:"finished"}],e.tlList=s.prevImg.split(",").map(function(t){return{name:t.split("/").pop(),url:t,status:"finished"}}),e.desc=s.desc})},getCates:function(){var t=this;this.$http.post("./category/getCates").then(function(e){t.categorys={};var s=!0,i=!1,n=void 0;try{for(var o,r=(0,a.default)(e.result);!(s=(o=r.next()).done);s=!0){var l=o.value;t.cateId||(t.cateId=l._id),t.$set(t.categorys,l._id,l.name)}}catch(t){i=!0,n=t}finally{try{!s&&r.return&&r.return()}finally{if(i)throw n}}})},sure:function(){var t=this,e="./goods/addGoods",s={name:this.name,price:this.price,desc:this.desc,cateId:this.cateId,cateName:this.categorys[this.cateId],isShow:this.isShow,mainImg:this.ztUploadFiles.map(function(t){return t.url}).toString(),prevImg:this.tLUploadFiles.map(function(t){return t.url}).toString()};if(!(this.name&&this.price&&this.desc&&this.ztUploadFiles.length&&this.tLUploadFiles.length))return this.$Message.error("请完整填写商品信息");this.goodsId&&(e="./goods/updateGoods",s.id=this.goodsId),this.$http.post(e,s).then(function(e){if(-1===e.code)return t.$Message.error(e.msg);t.$Message.success(e.msg),t.$router.push("goodsManage")})}}}},128:function(t,e,s){"use strict";s.r(e);var a=s(129),i=s.n(a);for(var n in a)"default"!==n&&function(t){s.d(e,t,function(){return a[t]})}(n);e.default=i.a},129:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["defaultList","uploadFiles","maxUploadLen"],data:function(){return{imgUrl:"",visible:!1,uploadList:[]}},mounted:function(){this.uploadList=this.$refs.upload.fileList},methods:{handleView:function(t){this.imgUrl=t.url,this.visible=!0},handleRemove:function(t){var e=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(e.indexOf(t),1)},handleSuccess:function(t,e){e.url=e.response.url,e.name=e.response.name},handleFormatError:function(t){this.$Message.error(t.name+"文件格式不对")},handleMaxSize:function(t){this.$Message.error(t.name+"文件大小不能超过1M")}},watch:{uploadList:function(){this.$emit("update:uploadFiles",this.uploadList)},defaultList:function(){var t=this;this.$nextTick(function(){t.uploadList=t.$refs.upload.fileList})}}}},130:function(t,e,s){},131:function(t,e,s){},147:function(t,e,s){"use strict";s.r(e);var a=s(158),i=s(128);for(var n in i)"default"!==n&&function(t){s.d(e,t,function(){return i[t]})}(n);s(148);var o=s(6),r=Object(o.a)(i.default,a.a,a.b,!1,null,"09ce479e",null);e.default=r.exports},148:function(t,e,s){"use strict";var a=s(130);s.n(a).a},149:function(t,e,s){"use strict";var a=s(131);s.n(a).a},152:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"addGoods"},[s("div",{staticClass:"row"},[s("label",[t._v("商品名称 :")]),t._v(" "),s("Input",{staticClass:"f-r",attrs:{placeholder:"请输入商品名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),s("div",{staticClass:"row"},[s("label",[t._v("商品价格 :")]),t._v(" "),s("Input",{staticClass:"f-r",attrs:{placeholder:"请输入商品名称"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),s("div",{staticClass:"row"},[s("label",[t._v("商品分类 :")]),t._v(" "),s("Select",{staticClass:"f-r",model:{value:t.cateId,callback:function(e){t.cateId=e},expression:"cateId"}},t._l(t.categorys,function(e,a){return s("Option",{key:a,attrs:{value:a}},[t._v(t._s(e))])}),1)],1),t._v(" "),s("div",{staticClass:"row"},[s("label",[t._v("上传主图 :")]),t._v(" "),s("div",{staticClass:"upload-wrap"},[s("upload",{attrs:{defaultList:t.ztList,maxUploadLen:"1",uploadFiles:t.ztUploadFiles},on:{"update:uploadFiles":function(e){t.ztUploadFiles=e},"update:upload-files":function(e){t.ztUploadFiles=e}}})],1)]),t._v(" "),s("div",{staticClass:"row"},[s("label",[t._v("商品图片 :")]),t._v(" "),s("div",{staticClass:"upload-wrap"},[s("upload",{attrs:{defaultList:t.tlList,maxUploadLen:"6",uploadFiles:t.tLUploadFiles},on:{"update:uploadFiles":function(e){t.tLUploadFiles=e},"update:upload-files":function(e){t.tLUploadFiles=e}}})],1)]),t._v(" "),s("div",{staticClass:"row"},[s("label",{attrs:{for:""}},[t._v("商品描述 :")]),t._v(" "),s("Input",{staticClass:"f-r",attrs:{type:"textarea",placeholder:"请输入商品描述"},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}})],1),t._v(" "),s("div",{staticClass:"row"},[s("label",{attrs:{for:""}},[t._v("是否显示 :")]),t._v(" "),s("i-switch",{staticClass:"switch",attrs:{size:"large"},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("显示")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("隐藏")])])],1),t._v(" "),s("div",{staticClass:"row alignCenter"},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.sure}},[t._v("确定")])],1)])},i=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return i})},158:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"upload"},[t._l(t.uploadList,function(e){return s("div",{staticClass:"upload-list"},["finished"===e.status?[s("img",{attrs:{src:e.url}}),t._v(" "),s("div",{staticClass:"upload-list-cover"},[s("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(s){return t.handleView(e)}}}),t._v(" "),s("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(s){return t.handleRemove(e)}}})],1)]:[e.showProgress?s("Progress",{attrs:{percent:e.percentage,"hide-info":""}}):t._e()]],2)}),t._v(" "),s("Upload",{directives:[{name:"show",rawName:"v-show",value:t.uploadList.length<t.maxUploadLen,expression:"uploadList.length < maxUploadLen"}],ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":t.defaultList,"on-success":t.handleSuccess,format:["jpg","jpeg","png"],"max-size":1024,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,multiple:"",type:"drag",action:"./upload/upload"}},[s("div",{staticClass:"camera"},[s("Icon",{attrs:{type:"camera",size:"20"}})],1)]),t._v(" "),s("Modal",{attrs:{title:"查看图片"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?s("img",{staticStyle:{width:"100%"},attrs:{src:t.imgUrl}}):t._e()])],2)},i=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return i})},99:function(t,e,s){"use strict";s.r(e);var a=s(152),i=s(126);for(var n in i)"default"!==n&&function(t){s.d(e,t,function(){return i[t]})}(n);s(149);var o=s(6),r=Object(o.a)(i.default,a.a,a.b,!1,null,"1a866636",null);e.default=r.exports}}]);